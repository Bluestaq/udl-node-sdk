// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.

import { maybeFilter } from 'unified-data-library-mcp/filtering';
import { Metadata, asTextContentResult } from 'unified-data-library-mcp/tools/types';

import { Tool } from '@modelcontextprotocol/sdk/types.js';
import Unifieddatalibrary from 'unified-data-library';

export const metadata: Metadata = {
  resource: 'effect_responses',
  operation: 'read',
  tags: [],
  httpMethod: 'get',
  httpPath: '/udl/effectresponse/{id}',
};

export const tool: Tool = {
  name: 'retrieve_effect_responses',
  description:
    "When using this tool, always use the `jq_filter` parameter to reduce the response size and improve performance.\n\nOnly omit if you're sure you don't need the data.\n\nService operation to get a single EffectResponse by its unique ID passed as a path parameter.\n\n# Response Schema\n```json\n{\n  type: 'object',\n  description: 'A response for various effects on a target.',\n  properties: {\n    classificationMarking: {\n      type: 'string',\n      description: 'Classification marking of the data in IC/CAPCO Portion-marked format.'\n    },\n    dataMode: {\n      type: 'string',\n      description: 'Indicator of whether the data is EXERCISE, REAL, SIMULATED, or TEST data:\\n\\nEXERCISE:&nbsp;Data pertaining to a government or military exercise. The data may include both real and simulated data.\\n\\nREAL:&nbsp;Data collected or produced that pertains to real-world objects, events, and analysis.\\n\\nSIMULATED:&nbsp;Synthetic data generated by a model to mimic real-world datasets.\\n\\nTEST:&nbsp;Specific datasets used to evaluate compliance with specifications and requirements, and for validating technical, functional, and performance characteristics.',\n      enum: [        'REAL',\n        'TEST',\n        'SIMULATED',\n        'EXERCISE'\n      ]\n    },\n    source: {\n      type: 'string',\n      description: 'Source of the data.'\n    },\n    type: {\n      type: 'string',\n      description: 'The type of response in this record (e.g. COA, SCORECARD, etc.).'\n    },\n    id: {\n      type: 'string',\n      description: 'Unique identifier of the record, auto-generated by the system.'\n    },\n    actionsList: {\n      type: 'array',\n      description: 'List of actions associated with this effect response.',\n      items: {\n        $ref: '#/$defs/effect_response_actions_list_full'\n      }\n    },\n    actorSrcId: {\n      type: 'string',\n      description: 'The record ID, depending on the type identified in actorSrcType, of the requested asset.'\n    },\n    actorSrcType: {\n      type: 'string',\n      description: 'The source type of the asset/actor identifier (AIRCRAFT, LANDCRAFT, SEACRAFT, TRACK).'\n    },\n    coaMetrics: {\n      type: 'array',\n      description: 'List of COA metrics associated with this effect response.',\n      items: {\n        $ref: '#/$defs/effect_response_metrics_full'\n      }\n    },\n    collateralDamageEst: {\n      type: 'number',\n      description: 'The collateral damage estimate (CDE) of the munition being fired.'\n    },\n    createdAt: {\n      type: 'string',\n      description: 'Time the row was created in the database, auto-populated by the system.',\n      format: 'date-time'\n    },\n    createdBy: {\n      type: 'string',\n      description: 'Application user who created the row in the database, auto-populated by the system.'\n    },\n    decisionDeadline: {\n      type: 'string',\n      description: 'The deadline time to accept this COA before it\\'s no longer valid, in ISO8601 UTC format.',\n      format: 'date-time'\n    },\n    externalActions: {\n      type: 'array',\n      description: 'List of external actions to be executed as part of this task.',\n      items: {\n        type: 'string'\n      }\n    },\n    externalRequestId: {\n      type: 'string',\n      description: 'The external system identifier of the associated effect request. A human readable unique id.'\n    },\n    idEffectRequest: {\n      type: 'string',\n      description: 'Unique identifier of the EffectRequest associated with this response.'\n    },\n    munitionId: {\n      type: 'string',\n      description: 'Unique identifier of the munition.'\n    },\n    munitionType: {\n      type: 'string',\n      description: 'The type of munition being fired.'\n    },\n    origin: {\n      type: 'string',\n      description: 'Originating system or organization which produced the data, if different from the source. The origin may be different than the source if the source was a mediating system which forwarded the data on behalf of the origin system. If null, the source may be assumed to be the origin.'\n    },\n    origNetwork: {\n      type: 'string',\n      description: 'The originating source network on which this record was created, auto-populated by the system.'\n    },\n    probabilityOfKill: {\n      type: 'number',\n      description: 'The probability of kill (0-1) of the target being destroyed.'\n    },\n    redTargetSrcId: {\n      type: 'string',\n      description: 'The record ID, depending on the type identified in redTargetSrcType, of the red force target.  If the redTargetSrcType is POI or TRACK, then this identifier corresponds to either poi.poiid or track.trkId from their respective schemas.'\n    },\n    redTargetSrcType: {\n      type: 'string',\n      description: 'The source type of the targetId identifier (POI, SITE, TRACK).'\n    },\n    redTimeToOverhead: {\n      type: 'string',\n      description: 'The time to overhead for the red force to be over their target, in ISO8601 UTC format.',\n      format: 'date-time'\n    },\n    shotsRequired: {\n      type: 'integer',\n      description: 'The number of shots required to destroy target.'\n    }\n  },\n  required: [    'classificationMarking',\n    'dataMode',\n    'source',\n    'type'\n  ],\n  $defs: {\n    effect_response_actions_list_full: {\n      type: 'object',\n      properties: {\n        actionActorSrcId: {\n          type: 'string',\n          description: 'The record ID, depending on the type identified in actorSrcType, of the requested asset/actor.'\n        },\n        actionActorSrcType: {\n          type: 'string',\n          description: 'The source type of the asset/actor identifier (AIRCRAFT, LANDCRAFT, SEACRAFT, TRACK).'\n        },\n        actionEndTime: {\n          type: 'string',\n          description: 'The desired end time of this task, in ISO8601 UTC format.',\n          format: 'date-time'\n        },\n        actionId: {\n          type: 'string',\n          description: 'Identifier of this action.'\n        },\n        actionMetrics: {\n          type: 'array',\n          description: 'List of metrics associated with this action.',\n          items: {\n            $ref: '#/$defs/effect_response_metrics_full'\n          }\n        },\n        actionStartTime: {\n          type: 'string',\n          description: 'The desired start time of this task, in ISO8601 UTC format.',\n          format: 'date-time'\n        },\n        actorInterceptAlt: {\n          type: 'number',\n          description: 'The WGS-84 altitude of the asset/actor location at weapon launch, in meters.'\n        },\n        actorInterceptLat: {\n          type: 'number',\n          description: 'The WGS-84 latitude of the asset/actor location at weapon launch, in degrees.  -90 to 90 degrees (negative values south of equator).'\n        },\n        actorInterceptLon: {\n          type: 'number',\n          description: 'The WGS-84 longitude of the asset/actor location at weapon launch, in degrees.  -180 to 180 degrees (negative values west of Prime Meridian).'\n        },\n        effector: {\n          type: 'string',\n          description: 'The type of munition or sensor used by this asset/actor.'\n        },\n        summary: {\n          type: 'string',\n          description: 'A summary string describing different aspects of the action.'\n        },\n        targetSrcId: {\n          type: 'string',\n          description: 'The POI or TRACK ID, depending on the type identified in targetSrcType, of the requested target. This identifier corresponds to either poi.poiid or track.trkId from their respective schemas.'\n        },\n        targetSrcType: {\n          type: 'string',\n          description: 'The source type of the targetId identifier (POI, TRACK).'\n        },\n        totEndTime: {\n          type: 'string',\n          description: 'The end time of the asset TOT (time over target), in ISO8601 UTC format.',\n          format: 'date-time'\n        },\n        totStartTime: {\n          type: 'string',\n          description: 'The start time of the asset TOT (time over target), in ISO8601 UTC format.',\n          format: 'date-time'\n        },\n        weaponInterceptAlt: {\n          type: 'number',\n          description: 'The WGS-84 altitude of the weapon destination location, in meters.'\n        },\n        weaponInterceptLat: {\n          type: 'number',\n          description: 'The WGS-84 latitude of the weapon destination location, in degrees.  -90 to 90 degrees (negative values south of equator).'\n        },\n        weaponInterceptLon: {\n          type: 'number',\n          description: 'The WGS-84 longitude of the weapon destination location, in degrees.  -180 to 180 degrees (negative values west of Prime Meridian).'\n        }\n      }\n    },\n    effect_response_metrics_full: {\n      type: 'object',\n      properties: {\n        domainValue: {\n          type: 'number',\n          description: 'The metric score specific to its domain.'\n        },\n        metricType: {\n          type: 'string',\n          description: 'The type of the metric (e.g. CollateralDamage, GoalAchievement, OpportunityCost, Timeliness, Unavailable, etc.).'\n        },\n        provenance: {\n          type: 'string',\n          description: 'The metric that was used to score this task.'\n        },\n        relativeValue: {\n          type: 'number',\n          description: 'The metric score adjusted to be relative and comparable to other domains.'\n        }\n      }\n    }\n  }\n}\n```",
  inputSchema: {
    type: 'object',
    properties: {
      id: {
        type: 'string',
      },
      firstResult: {
        type: 'integer',
      },
      maxResults: {
        type: 'integer',
      },
      jq_filter: {
        type: 'string',
        title: 'jq Filter',
        description:
          'A jq filter to apply to the response to include certain fields. Consult the output schema in the tool description to see the fields that are available.\n\nFor example: to include only the `name` field in every object of a results array, you can provide ".results[].name".\n\nFor more information, see the [jq documentation](https://jqlang.org/manual/).',
      },
    },
    required: ['id'],
  },
  annotations: {
    readOnlyHint: true,
  },
};

export const handler = async (client: Unifieddatalibrary, args: Record<string, unknown> | undefined) => {
  const { id, jq_filter, ...body } = args as any;
  return asTextContentResult(await maybeFilter(jq_filter, await client.effectResponses.retrieve(id, body)));
};

export default { metadata, tool, handler };
